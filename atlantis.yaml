version: 3
projects:
    - name: terraform-atlantis-workshop
      dir: terraform
      terraform_version: v1.6.0
      # Remove apply_requirements from here since ATLANTIS_REQUIRE_APPROVAL=true handles this

workflows:
    default:
        plan:
            steps:
                - env:
                      name: TF_IN_AUTOMATION
                      value: "true"
                - init
                - plan
        policy_check:
            steps:
                - policy_check
        apply:
            steps:
                - apply

policies:
    policy_sets:
        - name: cost_and_security
          path: /policies/
          source: local
